function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _libCanvasLayer = require('../lib/canvas-layer');

var _libCanvasLayer2 = _interopRequireDefault(_libCanvasLayer);

'use babel';

describe('CanvasLayer', function () {
  var _ref = [];
  var layer = _ref[0];

  beforeEach(function () {
    layer = new _libCanvasLayer2['default']();

    layer.setSize(100, 300);
  });

  it('has two canvas', function () {
    expect(layer.canvas).toBeDefined();
    expect(layer.offscreenCanvas).toBeDefined();
  });

  it('has a context for each canvas', function () {
    expect(layer.context).toBeDefined();
    expect(layer.offscreenContext).toBeDefined();
  });

  it('disables the smoothing for the canvas', function () {
    expect(layer.canvas.webkitImageSmoothingEnabled).toBeFalsy();
    expect(layer.offscreenCanvas.webkitImageSmoothingEnabled).toBeFalsy();

    expect(layer.context.imageSmoothingEnabled).toBeFalsy();
    expect(layer.offscreenContext.imageSmoothingEnabled).toBeFalsy();
  });

  describe('.prototype.attach', function () {
    it('attaches the onscreen canvas to the provided element', function () {
      var jasmineContent = document.body.querySelector('#jasmine-content');

      layer.attach(jasmineContent);

      expect(jasmineContent.querySelector('canvas')).toExist();
    });
  });

  describe('.prototype.resetOffscreenSize', function () {
    it('sets the width of the offscreen canvas to the ', function () {
      layer.canvas.width = 500;
      layer.canvas.height = 400;

      expect(layer.offscreenCanvas.width).toEqual(100);
      expect(layer.offscreenCanvas.height).toEqual(300);

      layer.resetOffscreenSize();

      expect(layer.offscreenCanvas.width).toEqual(500);
      expect(layer.offscreenCanvas.height).toEqual(400);
    });
  });

  describe('.prototype.copyToOffscreen', function () {
    it('copies the onscreen bitmap onto the offscreen canvas', function () {
      spyOn(layer.offscreenContext, 'drawImage');

      layer.copyToOffscreen();

      expect(layer.offscreenContext.drawImage).toHaveBeenCalledWith(layer.canvas, 0, 0);
    });
  });

  describe('.prototype.copyFromOffscreen', function () {
    it('copies the offscreen bitmap onto the onscreen canvas', function () {
      spyOn(layer.context, 'drawImage');

      layer.copyFromOffscreen();

      expect(layer.context.drawImage).toHaveBeenCalledWith(layer.offscreenCanvas, 0, 0);
    });
  });

  describe('.prototype.copyPartFromOffscren', function () {
    it('copies to the onscreen canvas the region that were specified', function () {
      spyOn(layer.context, 'drawImage');

      layer.copyPartFromOffscreen(50, 100, 150);

      expect(layer.context.drawImage).toHaveBeenCalledWith(layer.offscreenCanvas, 0, 50, 100, 150, 0, 100, 100, 150);
    });
  });

  describe('.prototype.clearCanvas', function () {
    it('clears the whole canvas region', function () {
      spyOn(layer.context, 'clearRect');

      layer.clearCanvas();

      expect(layer.context.clearRect).toHaveBeenCalledWith(0, 0, layer.canvas.width, layer.canvas.height);
    });
  });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2tleS8uYXRvbS9wYWNrYWdlcy9taW5pbWFwL3NwZWMvY2FudmFzLWxheWVyLXNwZWMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OEJBRXdCLHFCQUFxQjs7OztBQUY3QyxXQUFXLENBQUE7O0FBSVgsUUFBUSxDQUFDLGFBQWEsRUFBRSxZQUFNO2FBQ2QsRUFBRTtNQUFYLEtBQUs7O0FBRVYsWUFBVSxDQUFDLFlBQU07QUFDZixTQUFLLEdBQUcsaUNBQWlCLENBQUE7O0FBRXpCLFNBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFBO0dBQ3hCLENBQUMsQ0FBQTs7QUFFRixJQUFFLENBQUMsZ0JBQWdCLEVBQUUsWUFBTTtBQUN6QixVQUFNLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFBO0FBQ2xDLFVBQU0sQ0FBQyxLQUFLLENBQUMsZUFBZSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUE7R0FDNUMsQ0FBQyxDQUFBOztBQUVGLElBQUUsQ0FBQywrQkFBK0IsRUFBRSxZQUFNO0FBQ3hDLFVBQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUE7QUFDbkMsVUFBTSxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFBO0dBQzdDLENBQUMsQ0FBQTs7QUFFRixJQUFFLENBQUMsdUNBQXVDLEVBQUUsWUFBTTtBQUNoRCxVQUFNLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQywyQkFBMkIsQ0FBQyxDQUFDLFNBQVMsRUFBRSxDQUFBO0FBQzVELFVBQU0sQ0FBQyxLQUFLLENBQUMsZUFBZSxDQUFDLDJCQUEyQixDQUFDLENBQUMsU0FBUyxFQUFFLENBQUE7O0FBRXJFLFVBQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLHFCQUFxQixDQUFDLENBQUMsU0FBUyxFQUFFLENBQUE7QUFDdkQsVUFBTSxDQUFDLEtBQUssQ0FBQyxn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QUFBO0tBQ0YsQ0FBQyxDQUFBO0dBQ0gsQ0FBQyxDQUFBOztBQUVGLFVBQVEsQ0FBQyx3QkFBd0IsRUFBRSxZQUFNO0FBQ3ZDLE1BQUUsQ0FBQyxnQ0FBZ0MsRUFBRSxZQUFNO0FBQ3pDLFdBQUssQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUFFLFdBQVcsQ0FBQyxDQUFBOztBQUVqQyxXQUFLLENBQUMsV0FBVyxFQUFFLENBQUE7O0FBRW5CLFlBQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQTtLQUNwRyxDQUFDLENBQUE7R0FDSCxDQUFDLENBQUE7Q0FDSCxDQUFDLENBQUEiLCJmaWxlIjoiL2hvbWUva2V5Ly5hdG9tL3BhY2thZ2VzL21pbmltYXAvc3BlYy9jYW52YXMtbGF5ZXItc3BlYy5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2UgYmFiZWwnXG5cbmltcG9ydCBDYW52YXNMYXllciBmcm9tICcuLi9saWIvY2FudmFzLWxheWVyJ1xuXG5kZXNjcmliZSgnQ2FudmFzTGF5ZXInLCAoKSA9PiB7XG4gIGxldCBbbGF5ZXJdID0gW11cblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBsYXllciA9IG5ldyBDYW52YXNMYXllcigpXG5cbiAgICBsYXllci5zZXRTaXplKDEwMCwgMzAwKVxuICB9KVxuXG4gIGl0KCdoYXMgdHdvIGNhbnZhcycsICgpID0+IHtcbiAgICBleHBlY3QobGF5ZXIuY2FudmFzKS50b0JlRGVmaW5lZCgpXG4gICAgZXhwZWN0KGxheWVyLm9mZnNjcmVlbkNhbnZhcykudG9CZURlZmluZWQoKVxuICB9KVxuXG4gIGl0KCdoYXMgYSBjb250ZXh0IGZvciBlYWNoIGNhbnZhcycsICgpID0+IHtcbiAgICBleHBlY3QobGF5ZXIuY29udGV4dCkudG9CZURlZmluZWQoKVxuICAgIGV4cGVjdChsYXllci5vZmZzY3JlZW5Db250ZXh0KS50b0JlRGVmaW5lZCgpXG4gIH0pXG5cbiAgaXQoJ2Rpc2FibGVzIHRoZSBzbW9vdGhpbmcgZm9yIHRoZSBjYW52YXMnLCAoKSA9PiB7XG4gICAgZXhwZWN0KGxheWVyLmNhbnZhcy53ZWJraXRJbWFnZVNtb290aGluZ0VuYWJsZWQpLnRvQmVGYWxzeSgpXG4gICAgZXhwZWN0KGxheWVyLm9mZnNjcmVlbkNhbnZhcy53ZWJraXRJbWFnZVNtb290aGluZ0VuYWJsZWQpLnRvQmVGYWxzeSgpXG5cbiAgICBleHBlY3QobGF5ZXIuY29udGV4dC5pbWFnZVNtb290aGluZ0VuYWJsZWQpLnRvQmVGYWxzeSgpXG4gICAgZXhwZWN0KGxheWVyLm9mZnNjcmVlbkNvbnRleHQuaW1hZ2VTbW9vdGhpbmdFbmFibGVkKS50b0JlRmFsc3koKVxuICB9KVxuXG4gIGRlc2NyaWJlKCcucHJvdG90eXBlLmF0dGFjaCcsICgpID0+IHtcbiAgICBpdCgnYXR0YWNoZXMgdGhlIG9uc2NyZWVuIGNhbnZhcyB0byB0aGUgcHJvdmlkZWQgZWxlbWVudCcsICgpID0+IHtcbiAgICAgIGxldCBqYXNtaW5lQ29udGVudCA9IGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvcignI2phc21pbmUtY29udGVudCcpXG5cbiAgICAgIGxheWVyLmF0dGFjaChqYXNtaW5lQ29udGVudClcblxuICAgICAgZXhwZWN0KGphc21pbmVDb250ZW50LnF1ZXJ5U2VsZWN0b3IoJ2NhbnZhcycpKS50b0V4aXN0KClcbiAgICB9KVxuICB9KVxuXG4gIGRlc2NyaWJlKCcucHJvdG90eXBlLnJlc2V0T2Zmc2NyZWVuU2l6ZScsICgpID0+IHtcbiAgICBpdCgnc2V0cyB0aGUgd2lkdGggb2YgdGhlIG9mZnNjcmVlbiBjYW52YXMgdG8gdGhlICcsICgpID0+IHtcbiAgICAgIGxheWVyLmNhbnZhcy53aWR0aCA9IDUwMFxuICAgICAgbGF5ZXIuY2FudmFzLmhlaWdodCA9IDQwMFxuXG4gICAgICBleHBlY3QobGF5ZXIub2Zmc2NyZWVuQ2FudmFzLndpZHRoKS50b0VxdWFsKDEwMClcbiAgICAgIGV4cGVjdChsYXllci5vZmZzY3JlZW5DYW52YXMuaGVpZ2h0KS50b0VxdWFsKDMwMClcblxuICAgICAgbGF5ZXIucmVzZXRPZmZzY3JlZW5TaXplKClcblxuICAgICAgZXhwZWN0KGxheWVyLm9mZnNjcmVlbkNhbnZhcy53aWR0aCkudG9FcXVhbCg1MDApXG4gICAgICBleHBlY3QobGF5ZXIub2Zmc2NyZWVuQ2FudmFzLmhlaWdodCkudG9FcXVhbCg0MDApXG4gICAgfSlcbiAgfSlcblxuICBkZXNjcmliZSgnLnByb3RvdHlwZS5jb3B5VG9PZmZzY3JlZW4nLCAoKSA9PiB7XG4gICAgaXQoJ2NvcGllcyB0aGUgb25zY3JlZW4gYml0bWFwIG9udG8gdGhlIG9mZnNjcmVlbiBjYW52YXMnLCAoKSA9PiB7XG4gICAgICBzcHlPbihsYXllci5vZmZzY3JlZW5Db250ZXh0LCAnZHJhd0ltYWdlJylcblxuICAgICAgbGF5ZXIuY29weVRvT2Zmc2NyZWVuKClcblxuICAgICAgZXhwZWN0KGxheWVyLm9mZnNjcmVlbkNvbnRleHQuZHJhd0ltYWdlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChsYXllci5jYW52YXMsIDAsIDApXG4gICAgfSlcbiAgfSlcblxuICBkZXNjcmliZSgnLnByb3RvdHlwZS5jb3B5RnJvbU9mZnNjcmVlbicsICgpID0+IHtcbiAgICBpdCgnY29waWVzIHRoZSBvZmZzY3JlZW4gYml0bWFwIG9udG8gdGhlIG9uc2NyZWVuIGNhbnZhcycsICgpID0+IHtcbiAgICAgIHNweU9uKGxheWVyLmNvbnRleHQsICdkcmF3SW1hZ2UnKVxuXG4gICAgICBsYXllci5jb3B5RnJvbU9mZnNjcmVlbigpXG5cbiAgICAgIGV4cGVjdChsYXllci5jb250ZXh0LmRyYXdJbWFnZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgobGF5ZXIub2Zmc2NyZWVuQ2FudmFzLCAwLCAwKVxuICAgIH0pXG4gIH0pXG5cbiAgZGVzY3JpYmUoJy5wcm90b3R5cGUuY29weVBhcnRGcm9tT2Zmc2NyZW4nLCAoKSA9PiB7XG4gICAgaXQoJ2NvcGllcyB0byB0aGUgb25zY3JlZW4gY2FudmFzIHRoZSByZWdpb24gdGhhdCB3ZXJlIHNwZWNpZmllZCcsICgpID0+IHtcbiAgICAgIHNweU9uKGxheWVyLmNvbnRleHQsICdkcmF3SW1hZ2UnKVxuXG4gICAgICBsYXllci5jb3B5UGFydEZyb21PZmZzY3JlZW4oNTAsIDEwMCwgMTUwKVxuXG4gICAgICBleHBlY3QobGF5ZXIuY29udGV4dC5kcmF3SW1hZ2UpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBsYXllci5vZmZzY3JlZW5DYW52YXMsXG4gICAgICAgIDAsIDUwLCAxMDAsIDE1MCxcbiAgICAgICAgMCwgMTAwLCAxMDAsIDE1MFxuICAgICAgKVxuICAgIH0pXG4gIH0pXG5cbiAgZGVzY3JpYmUoJy5wcm90b3R5cGUuY2xlYXJDYW52YXMnLCAoKSA9PiB7XG4gICAgaXQoJ2NsZWFycyB0aGUgd2hvbGUgY2FudmFzIHJlZ2lvbicsICgpID0+IHtcbiAgICAgIHNweU9uKGxheWVyLmNvbnRleHQsICdjbGVhclJlY3QnKVxuXG4gICAgICBsYXllci5jbGVhckNhbnZhcygpXG5cbiAgICAgIGV4cGVjdChsYXllci5jb250ZXh0LmNsZWFyUmVjdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoMCwgMCwgbGF5ZXIuY2FudmFzLndpZHRoLCBsYXllci5jYW52YXMuaGVpZ2h0KVxuICAgIH0pXG4gIH0pXG59KVxuIl19
//# sourceURL=/home/key/.atom/packages/minimap/spec/canvas-layer-spec.js
